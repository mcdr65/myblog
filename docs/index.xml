<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Stats and other things</title>
<link>https://mcdr65.github.io/myblog/index.html</link>
<atom:link href="https://mcdr65.github.io/myblog/index.xml" rel="self" type="application/rss+xml"/>
<description>This is André Meichtry's personal Blog</description>
<generator>quarto-1.1.251</generator>
<lastBuildDate>Wed, 02 Nov 2022 23:00:00 GMT</lastBuildDate>
<item>
  <title>Compositions</title>
  <dc:creator>André Meichtry</dc:creator>
  <link>https://mcdr65.github.io/myblog/posts/logratioGeometry/index.html</link>
  <description><![CDATA[ <p><img src="https://latex.codecogs.com/png.latex?%5Cmathcal%7BS%7D%5E4=%5C%7B%5Cmathbf%7Bx%7D=%5Bx_1,x_2,x_3,x_4%5D%5Cin%20%5Cmathbb%7BR%7D%5E4%20%5Cmid%20x_i%3E0,%20i=1,2,3,4;%20%5Csum_%7Bi=1%7D%5E4x_i=%5Cmathcal%7Bk%7D%5C%7D"></p>
<div class="cell" data-webgl="true">
<details><summary>Code</summary><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;">plot3D</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">datAitch</span>,col<span class="op" style="color: #5E5E5E;">=</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">Rater</span><span class="op" style="color: #5E5E5E;">)</span>,size<span class="op" style="color: #5E5E5E;">=</span><span class="fl" style="color: #AD0000;">5</span>,axes<span class="op" style="color: #5E5E5E;">=</span><span class="cn" style="color: #8f5902;">TRUE</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div id="rgl38466" style="width:100%;height:464px;" class="rglWebGL html-widget"></div>
<script type="application/json" data-for="rgl38466">{"x":{"material":{"color":"#000000","alpha":1,"lit":true,"ambient":"#000000","specular":"#FFFFFF","emission":"#000000","shininess":50,"smooth":true,"front":"filled","back":"filled","size":3,"lwd":1,"fog":true,"point_antialias":false,"line_antialias":false,"texture":null,"textype":"rgb","texmipmap":false,"texminfilter":"linear","texmagfilter":"linear","texenvmap":false,"depth_mask":true,"depth_test":"less","isTransparent":false,"polygon_offset":[0,0],"margin":"","floating":false,"tag":""},"rootSubscene":7,"objects":{"13":{"id":13,"type":"linestrip","material":{"lit":false,"size":2},"vertices":"0","colors":"1","centers":"2","ignoreExtent":false,"flags":32832},"14":{"id":14,"type":"points","material":{"lit":false,"size":5},"vertices":"3","colors":"4","centers":"5","ignoreExtent":false,"flags":34816},"15":{"id":15,"type":"text","material":{"lit":false},"vertices":"6","colors":"7","texts":[["peripheral"],["central"],["cortical"],["vegetative"]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"8","family":[["bitmap"]],"font":[[1]],"ignoreExtent":false,"flags":33808},"11":{"id":11,"type":"light","vertices":[[0,0,1]],"colors":[[1,1,1,1],[1,1,1,1],[1,1,1,1]],"viewpoint":true,"finite":false},"10":{"id":10,"type":"background","material":{},"colors":"9","centers":"10","sphere":false,"fogtype":"none","fogscale":1,"flags":32768},"12":{"id":12,"type":"background","material":{"lit":false,"back":"lines"},"colors":"11","centers":"12","sphere":false,"fogtype":"none","fogscale":1,"flags":32768},"7":{"id":7,"type":"subscene","par3d":{"antialias":8,"FOV":30,"ignoreExtent":false,"listeners":7,"mouseMode":{"none":"none","left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,4.24714517593384],"modelMatrix":[[1,0,0,0],[0,1,0,-0.20412415266037],[0,0,1,-4.53582048416138],[0,0,0,1]],"projMatrix":[[3.73205065727234,0,0,0],[0,3.73205065727234,0,0],[0,0,-3.86370325088501,-15.3104658126831],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[1,1,1],"viewport":{"x":0,"y":0,"width":1,"height":1},"zoom":1,"bbox":[-0.70710676908493,0.70710676908493,-0.40824830532074,0.816496610641479,-0.288675129413605,0.866025388240814],"windowRect":[518,209,774,465],"family":"bitmap","font":1,"cex":1,"useFreeType":false,"fontname":"fixed","maxClipPlanes":8,"glVersion":4.6,"activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"replace"},"objects":[12,13,14,15,11],"subscenes":[],"flags":36176}},"crosstalk":{"key":[],"group":[],"id":[],"options":[]},"width":672,"height":480,"context":{"shiny":false,"rmarkdown":null},"buffer":{"accessors":[{"bufferView":0,"componentType":5126,"count":8,"type":"VEC3"},{"bufferView":1,"componentType":5126,"count":1,"type":"VEC4"},{"bufferView":2,"componentType":5126,"count":8,"type":"VEC3"},{"bufferView":3,"componentType":5126,"count":80,"type":"VEC3"},{"bufferView":4,"componentType":5126,"count":80,"type":"VEC4"},{"bufferView":5,"componentType":5126,"count":80,"type":"VEC3"},{"bufferView":6,"componentType":5126,"count":4,"type":"VEC3"},{"bufferView":7,"componentType":5126,"count":1,"type":"VEC4"},{"bufferView":8,"componentType":5126,"count":4,"type":"VEC3"},{"bufferView":9,"componentType":5126,"count":1,"type":"VEC4"},{"bufferView":10,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":11,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":12,"componentType":5121,"count":1,"type":"VEC3"}],"bufferViews":[{"buffer":0,"byteLength":96,"byteOffset":0},{"buffer":0,"byteLength":16,"byteOffset":96},{"buffer":0,"byteLength":96,"byteOffset":112},{"buffer":0,"byteLength":960,"byteOffset":208},{"buffer":0,"byteLength":1280,"byteOffset":1168},{"buffer":0,"byteLength":960,"byteOffset":2448},{"buffer":0,"byteLength":48,"byteOffset":3408},{"buffer":0,"byteLength":16,"byteOffset":3456},{"buffer":0,"byteLength":48,"byteOffset":3472},{"buffer":0,"byteLength":16,"byteOffset":3520},{"buffer":0,"byteLength":3,"byteOffset":3536},{"buffer":0,"byteLength":4,"byteOffset":3539},{"buffer":0,"byteLength":3,"byteOffset":3543}],"buffers":[{"byteLength":3546,"bytes":"8wQ1v+wF0b46zZO+8wQ1P+wF0b46zZO+AAAAAOwFUT86zZO+AAAAAAAAAADXs10/8wQ1v+wF\n0b46zZO+AAAAAOwFUT86zZO+8wQ1P+wF0b46zZO+AAAAAAAAAADXs10/v74+P7++Pj+/vj4/\nAACAP/MENb/sBdG+Os2TvvMENT/sBdG+Os2TvgAAAADsBVE/Os2TvgAAAAAAAAAA17NdP/ME\nNb/sBdG+Os2TvgAAAADsBVE/Os2TvvMENT/sBdG+Os2TvgAAAAAAAAAA17NdP8PQkD2Gqcg8\nm9VUvsPQkD3n0/o9rFwxvsPQED1xxJw+rFwxvsPQED7wNye9kHtsPSQ5WT7wN6c9kHtsPiQ5\n2T1xxJw+rFwxvlDHrb1ZxgW9QPqHvgAAAAAAAAAArFwxPsPQkD3n0/o9rFwxPsPQED3yUBK+\nkHtsvcPQEL3n03q9rFwxviQ52T7wNye9kHvsvQAAAADwN6c9kHvsvcPQEL3p7GU+kHtsviQ5\nWT7wNye9Os2TvsPQED4AAMCjrFwxvsPQEL1z3Ye+kHtsvvMENT7wN6e8kHtsvgAAAADn0/o+\nrFwxPsPQkD7n0/o9AACAosPQkD0AAAAArFwxvsPQkD7wN6c9Os2TvgAAAADwNyc+Os2TPiQ5\n2T7wNye+kHtsPVRtfT7wN6c8kHtsPcPQkD7n03o+rFwxvsPQED3sBdE9kHtsvcPQkL7wNye+\nkHtsPcPQkD3n0/o9rFwxPsPQED1z3Yc+kHtsPQAAAADyUJI+kHvsPdvqoj7sBdE9kHtsvvME\nNT7yUBI+kHtsPcPQED7yUJI+kHtsviQ52T3sBdE9kHtsvsPQED4AAMCjrFwxvsPQED7wNye+\nOs2Tvtvqoj7n03o9rFwxvgAAAADsBdE+kHvsPfMENT7yUBI+kHtsPQAAAABZxgU8Os2TviQ5\nWb7yUJK+Os2TvsPQkD3sBVE+kHtsPSQ52T3uHjy+AAAAo8PQkD7n03o+rFwxvsPQED7wNye+\nOs2TvvMEtT7wNyc9kHtsvSQ5WT7wNye9kHtsPWq0Z7wcG2q9Os2TPsPQkL3sBVE+HuzOPq2J\nJr6IwjM+oQJJvvMEtT7wNye9kHtsPdvqor7sBdE9kHtsvvMEtT7wNye9Os2TviJmsT6EkF0+\nOs2TvsPQkD4AAAAArFwxvsWjuD5Te0Q+Os2TviQ52T7wN6c9Os2TvgAAAADp7OU+kHtsPlRt\nfT7sBdE9kHtsvcPQkD4cG2o9somlvVDHLT7sBVE+somlvZdCvD2/Io49soklPk70hT6Cd/K9\nkHvsPbEv9j2IwjO+oQJJPvMENT7p7GU+kHtsvZkV5D63vuG9veMNvlDHrT278Le9kHtsPpdC\nvL278De9KUa3PglMnz0gTcA9oQJJPlDHrbzuHjw+veMNPVRtfT6K2569py+9PAlMnz1xxJw+\nAAAAAMPQkD3n03o+m9XUvSQ52b1XrRq+lqhgvlDHLT5ZxoU9py89PFDHLT0kfxa+m9XUvcPQ\nkD7wN6e9kHtsvcPQEL1z3Yc+kHtsPlRtfT7wN6c8kHtsPQAAAAAAAAAAAAAAAAAAgD8AAAAA\nAAAAAAAAAAAAAIA/AAAAAAAAAAAAAAAAAACAPwAAAAAAAAAAAAAAAAAAgD8AAAAAAAAAAAAA\nAAAAAIA/AAAAAAAAAAAAAAAAAACAPwAAAAAAAAAAAAAAAAAAgD8AAAAAAAAAAAAAAAAAAIA/\nAAAAAAAAAAAAAAAAAACAPwAAAAAAAAAAAAAAAAAAgD8AAAAAAAAAAAAAAAAAAIA/AAAAAAAA\nAAAAAAAAAACAPwAAAAAAAAAAAAAAAAAAgD8AAAAAAAAAAAAAAAAAAIA/AAAAAAAAAAAAAAAA\nAACAPwAAAAAAAAAAAAAAAAAAgD8AAAAAAAAAAAAAAAAAAIA/AAAAAAAAAAAAAAAAAACAPwAA\nAAAAAAAAAAAAAAAAgD8AAAAAAAAAAAAAAAAAAIA/4N9fP6empj7X1tY+AACAP+DfXz+npqY+\n19bWPgAAgD/g318/p6amPtfW1j4AAIA/4N9fP6empj7X1tY+AACAP+DfXz+npqY+19bWPgAA\ngD/g318/p6amPtfW1j4AAIA/4N9fP6empj7X1tY+AACAP+DfXz+npqY+19bWPgAAgD/g318/\np6amPtfW1j4AAIA/4N9fP6empj7X1tY+AACAP+DfXz+npqY+19bWPgAAgD/g318/p6amPtfW\n1j4AAIA/4N9fP6empj7X1tY+AACAP+DfXz+npqY+19bWPgAAgD/g318/p6amPtfW1j4AAIA/\n4N9fP6empj7X1tY+AACAP+DfXz+npqY+19bWPgAAgD/g318/p6amPtfW1j4AAIA/4N9fP6em\npj7X1tY+AACAP+DfXz+npqY+19bWPgAAgD/DwsI+0dBQP5+enj4AAIA/w8LCPtHQUD+fnp4+\nAACAP8PCwj7R0FA/n56ePgAAgD/DwsI+0dBQP5+enj4AAIA/w8LCPtHQUD+fnp4+AACAP8PC\nwj7R0FA/n56ePgAAgD/DwsI+0dBQP5+enj4AAIA/w8LCPtHQUD+fnp4+AACAP8PCwj7R0FA/\nn56ePgAAgD/DwsI+0dBQP5+enj4AAIA/w8LCPtHQUD+fnp4+AACAP8PCwj7R0FA/n56ePgAA\ngD/DwsI+0dBQP5+enj4AAIA/w8LCPtHQUD+fnp4+AACAP8PCwj7R0FA/n56ePgAAgD/DwsI+\n0dBQP5+enj4AAIA/w8LCPtHQUD+fnp4+AACAP8PCwj7R0FA/n56ePgAAgD/DwsI+0dBQP5+e\nnj4AAIA/w8LCPtHQUD+fnp4+AACAP4mICD6Ylxc/5+ZmPwAAgD+JiAg+mJcXP+fmZj8AAIA/\niYgIPpiXFz/n5mY/AACAP4mICD6Ylxc/5+ZmPwAAgD+JiAg+mJcXP+fmZj8AAIA/iYgIPpiX\nFz/n5mY/AACAP4mICD6Ylxc/5+ZmPwAAgD+JiAg+mJcXP+fmZj8AAIA/iYgIPpiXFz/n5mY/\nAACAP4mICD6Ylxc/5+ZmPwAAgD+JiAg+mJcXP+fmZj8AAIA/iYgIPpiXFz/n5mY/AACAP4mI\nCD6Ylxc/5+ZmPwAAgD+JiAg+mJcXP+fmZj8AAIA/iYgIPpiXFz/n5mY/AACAP4mICD6Ylxc/\n5+ZmPwAAgD+JiAg+mJcXP+fmZj8AAIA/iYgIPpiXFz/n5mY/AACAP4mICD6Ylxc/5+ZmPwAA\ngD+JiAg+mJcXP+fmZj8AAIA/w9CQPYapyDyb1VS+w9CQPefT+j2sXDG+w9AQPXHEnD6sXDG+\nw9AQPvA3J72Qe2w9JDlZPvA3pz2Qe2w+JDnZPXHEnD6sXDG+UMetvVnGBb1A+oe+AAAAAAAA\nAACsXDE+w9CQPefT+j2sXDE+w9AQPfJQEr6Qe2y9w9AQvefTer2sXDG+JDnZPvA3J72Qe+y9\nAAAAAPA3pz2Qe+y9w9AQvensZT6Qe2y+JDlZPvA3J706zZO+w9AQPgAAwKOsXDG+w9AQvXPd\nh76Qe2y+8wQ1PvA3p7yQe2y+AAAAAOfT+j6sXDE+w9CQPufT+j0AAICiw9CQPQAAAACsXDG+\nw9CQPvA3pz06zZO+AAAAAPA3Jz46zZM+JDnZPvA3J76Qe2w9VG19PvA3pzyQe2w9w9CQPufT\nej6sXDG+w9AQPewF0T2Qe2y9w9CQvvA3J76Qe2w9w9CQPefT+j2sXDE+w9AQPXPdhz6Qe2w9\nAAAAAPJQkj6Qe+w92+qiPuwF0T2Qe2y+8wQ1PvJQEj6Qe2w9w9AQPvJQkj6Qe2y+JDnZPewF\n0T2Qe2y+w9AQPgAAwKOsXDG+w9AQPvA3J746zZO+2+qiPufTej2sXDG+AAAAAOwF0T6Qe+w9\n8wQ1PvJQEj6Qe2w9AAAAAFnGBTw6zZO+JDlZvvJQkr46zZO+w9CQPewFUT6Qe2w9JDnZPe4e\nPL4AAACjw9CQPufTej6sXDG+w9AQPvA3J746zZO+8wS1PvA3Jz2Qe2y9JDlZPvA3J72Qe2w9\narRnvBwbar06zZM+w9CQvewFUT4e7M4+rYkmvojCMz6hAkm+8wS1PvA3J72Qe2w92+qivuwF\n0T2Qe2y+8wS1PvA3J706zZO+ImaxPoSQXT46zZO+w9CQPgAAAACsXDG+xaO4PlN7RD46zZO+\nJDnZPvA3pz06zZO+AAAAAOns5T6Qe2w+VG19PuwF0T2Qe2y9w9CQPhwbaj2yiaW9UMctPuwF\nUT6yiaW9l0K8Pb8ijj2yiSU+TvSFPoJ38r2Qe+w9sS/2PYjCM76hAkk+8wQ1PunsZT6Qe2y9\nmRXkPre+4b294w2+UMetPbvwt72Qe2w+l0K8vbvwN70pRrc+CUyfPSBNwD2hAkk+UMetvO4e\nPD694w09VG19Porbnr2nL708CUyfPXHEnD4AAAAAw9CQPefTej6b1dS9JDnZvVetGr6WqGC+\nUMctPlnGhT2nLz08UMctPSR/Fr6b1dS9w9CQPvA3p72Qe2y9w9AQvXPdhz6Qe2w+VG19PvA3\npzyQe2w98wQ1v+wF0b46zZO+8wQ1P+wF0b46zZO+AAAAAOwFUT86zZO+AAAAAAAAAADXs10/\nv74+P7++Pj+/vj4/AACAP/MENb/sBdG+Os2TvvMENT/sBdG+Os2TvgAAAADsBVE/Os2TvgAA\nAAAAAAAA17NdP5mYmD6ZmJg+mZiYPgAAgD8AAAABAQEBAAAA"}]},"players":[],"webGLoptions":{"preserveDrawingBuffer":true}},"evals":[],"jsHooks":[]}</script>
</div>



 ]]></description>
  <category>code</category>
  <category>analysis</category>
  <guid>https://mcdr65.github.io/myblog/posts/logratioGeometry/index.html</guid>
  <pubDate>Wed, 02 Nov 2022 23:00:00 GMT</pubDate>
</item>
<item>
  <title>Beyond linearity</title>
  <dc:creator>André Meichtry</dc:creator>
  <link>https://mcdr65.github.io/myblog/posts/fromLMtoSplines/index.html</link>
  <description><![CDATA[ <section id="example-data" class="level2"><h2 class="anchored" data-anchor-id="example-data">Example Data</h2>
<p>Triceps skinfold thickness dataset: The data are derived from an anthropometric study of 892 females under 50 years in three Gambian villages in West Africa.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">MultiKink</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://personality-project.org/r/psych/">psych</a></span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'psych'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:ggplot2':

    %+%, alpha</code></pre>
</div>
</div>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">"triceps"</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/psych/man/headtail.html">headTail</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>      age lntriceps triceps
1   12.05      1.22     3.4
2    9.91      1.39       4
3   10.04      1.44     4.2
4   11.49      1.44     4.2
...   ...       ...     ...
889  7.91      1.92     6.8
890  7.99      1.44     4.2
891 14.63       2.2       9
892 30.14       2.1     8.2</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">tri.age.plot</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">triceps</span>, <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>x<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">age</span>, y<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>                 <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op" style="color: #5E5E5E;">(</span>alpha<span class="op" style="color: #5E5E5E;">=</span><span class="fl" style="color: #AD0000;">0.55</span>, color<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"black"</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span> </span>
<span>                 <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> </span>
<span><span class="va" style="color: #111111;">tri.age.plot</span></span></code></pre></div>
</details><div class="cell-output-display">
<p><img src="https://mcdr65.github.io/myblog/posts/fromLMtoSplines/index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="polynomial-regression" class="level2"><h2 class="anchored" data-anchor-id="polynomial-regression">Polynomial regression</h2>
<p>Using <code><a href="https://rdrr.io/r/stats/poly.html">poly()</a></code> in <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code>:</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">model.cubic.poly</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">~</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">age</span>,<span class="fl" style="color: #AD0000;">3</span>,raw<span class="op" style="color: #5E5E5E;">=</span><span class="cn" style="color: #8f5902;">TRUE</span><span class="op" style="color: #5E5E5E;">)</span>,data<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="co" style="color: #5E5E5E;">## the same model:</span></span>
<span><span class="co" style="color: #5E5E5E;">## model.cubic &lt;- lm(triceps~age + I(age^2) + I(age^3),</span></span>
<span><span class="co" style="color: #5E5E5E;">##                   data=triceps)</span></span>
<span><span class="va" style="color: #111111;">tri.age.plot</span> <span class="op" style="color: #5E5E5E;">+</span> </span>
<span>   <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">stat_smooth</a></span><span class="op" style="color: #5E5E5E;">(</span>method <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"lm"</span>, </span>
<span>               formula <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">y</span><span class="op" style="color: #5E5E5E;">~</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">x</span>,<span class="fl" style="color: #AD0000;">3</span>,raw<span class="op" style="color: #5E5E5E;">=</span><span class="cn" style="color: #8f5902;">T</span><span class="op" style="color: #5E5E5E;">)</span>, size <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<p><img src="https://mcdr65.github.io/myblog/posts/fromLMtoSplines/index_files/figure-html/polynomial-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="cross-validation-of-different-polynomials" class="level2"><h2 class="anchored" data-anchor-id="cross-validation-of-different-polynomials">Cross-validation of different polynomials</h2>
<section id="rmse-for-quadratic" class="level3"><h3 class="anchored" data-anchor-id="rmse-for-quadratic">RMSE for quadratic</h3>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;"><a href="https://github.com/topepo/caret/">caret</a></span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lattice</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">1234</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">trC.lm</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/caret/man/trainControl.html">trainControl</a></span><span class="op" style="color: #5E5E5E;">(</span>method <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"repeatedcv"</span>, </span>
<span>                       number <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">10</span>,         </span>
<span>                       repeats <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">10</span><span class="op" style="color: #5E5E5E;">)</span>        </span>
<span><span class="va" style="color: #111111;">pol.model</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/caret/man/train.html">train</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">triceps</span> <span class="op" style="color: #5E5E5E;">~</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">age</span>,<span class="fl" style="color: #AD0000;">3</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>                       data <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">triceps</span>, </span>
<span>                       method <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"lm"</span>,</span>
<span>                       trControl <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">trC.lm</span><span class="op" style="color: #5E5E5E;">)</span>    </span>
<span><span class="va" style="color: #111111;">pol.model</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">results</span><span class="op" style="color: #5E5E5E;">[</span><span class="fl" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">]</span></span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>      RMSE
1 3.865866</code></pre>
</div>
</div>
</section><section id="rmse-for-different-degrees" class="level3"><h3 class="anchored" data-anchor-id="rmse-for-different-degrees">RMSE for different degrees</h3>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">my.pol.f</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="kw" style="color: #003B4F;">function</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">x</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">{</span></span>
<span>    <span class="va" style="color: #111111;">xx</span><span class="op" style="color: #5E5E5E;">&lt;-</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">age</span>, <span class="va" style="color: #111111;">x</span>, raw<span class="op" style="color: #5E5E5E;">=</span><span class="cn" style="color: #8f5902;">T</span><span class="op" style="color: #5E5E5E;">)</span>    </span>
<span>    <span class="va" style="color: #111111;">new.data</span>  <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op" style="color: #5E5E5E;">(</span>triceps<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">triceps</span>, <span class="va" style="color: #111111;">xx</span><span class="op" style="color: #5E5E5E;">)</span>                                 </span>
<span>    <span class="va" style="color: #111111;">pol.model</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/caret/man/train.html">train</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">~</span><span class="va" style="color: #111111;">.</span>, data <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">new.data</span>,method <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"lm"</span><span class="op" style="color: #5E5E5E;">)</span>    </span>
<span>    <span class="va" style="color: #111111;">RMSE.cv</span> <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">pol.model</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">results</span><span class="op" style="color: #5E5E5E;">[</span><span class="fl" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">]</span></span>
<span>  <span class="op" style="color: #5E5E5E;">}</span></span>
<span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">:</span><span class="fl" style="color: #AD0000;">10</span>, <span class="va" style="color: #111111;">my.pol.f</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>     RMSE     RMSE     RMSE     RMSE    RMSE     RMSE     RMSE     RMSE     RMSE     RMSE    
[1,] 3.984711 4.083302 3.830449 3.77627 3.787051 3.740982 3.847184 3.803367 3.866925 3.803712</code></pre>
</div>
</div>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb14" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">tri.age.plot</span> <span class="op" style="color: #5E5E5E;">+</span> </span>
<span>   <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">stat_smooth</a></span><span class="op" style="color: #5E5E5E;">(</span>method <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"lm"</span>, </span>
<span>               formula <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">y</span><span class="op" style="color: #5E5E5E;">~</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">x</span>,<span class="fl" style="color: #AD0000;">6</span>,raw<span class="op" style="color: #5E5E5E;">=</span><span class="cn" style="color: #8f5902;">T</span><span class="op" style="color: #5E5E5E;">)</span>, size <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<p><img src="https://mcdr65.github.io/myblog/posts/fromLMtoSplines/index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section></section><section id="piecewise-linear-regression" class="level2"><h2 class="anchored" data-anchor-id="piecewise-linear-regression">Piecewise linear regression</h2>
<p>Instead of fitting a high-degree polynomial over the entire range of <img src="https://latex.codecogs.com/png.latex?X">, piecewise polynomial regression involves fitting separate low-degree polynomials over different regions of <img src="https://latex.codecogs.com/png.latex?X">. For example, a piecewise cubic polynomial works by fitting a cubic regression model of the form</p>
<p><img src="https://latex.codecogs.com/png.latex?Y_i=%5Cbeta_0+%5Cbeta_1x_i+%5Cbeta_2x_i%5E2+%5Cbeta_3x_i%5E3+%5Cepsilon_i,"></p>
<p>where the coefficients differ in different parts of the range of <img src="https://latex.codecogs.com/png.latex?X">. The points where the coefficients change are called <em>knots</em> <img src="https://latex.codecogs.com/png.latex?%5Cxi_k">, <img src="https://latex.codecogs.com/png.latex?k=1,%5Cdots,K">.</p>
<p>Let us begin with a piecewise linear (degree=1):</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb15" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">pred1</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">~</span><span class="va" style="color: #111111;">age</span>, </span>
<span>                    data <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">[</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">&lt;</span><span class="fl" style="color: #AD0000;">5</span>,<span class="op" style="color: #5E5E5E;">]</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">pred2</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">~</span><span class="va" style="color: #111111;">age</span>, </span>
<span>                    data <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">[</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">age</span> <span class="op" style="color: #5E5E5E;">&gt;=</span><span class="fl" style="color: #AD0000;">5</span> <span class="op" style="color: #5E5E5E;">&amp;</span> <span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">&lt;</span><span class="fl" style="color: #AD0000;">10</span>,<span class="op" style="color: #5E5E5E;">]</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">pred3</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">~</span><span class="va" style="color: #111111;">age</span>, </span>
<span>                    data <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">[</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">&gt;=</span><span class="fl" style="color: #AD0000;">10</span> <span class="op" style="color: #5E5E5E;">&amp;</span> <span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">&lt;</span><span class="fl" style="color: #AD0000;">20</span>,<span class="op" style="color: #5E5E5E;">]</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">pred4</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">~</span><span class="va" style="color: #111111;">age</span>, </span>
<span>                    data <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">[</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">&gt;=</span><span class="fl" style="color: #AD0000;">20</span> <span class="op" style="color: #5E5E5E;">&amp;</span> <span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">&lt;</span><span class="fl" style="color: #AD0000;">30</span>,<span class="op" style="color: #5E5E5E;">]</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">pred5</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">~</span><span class="va" style="color: #111111;">age</span>, </span>
<span>                    data <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">[</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">&gt;=</span><span class="fl" style="color: #AD0000;">30</span> <span class="op" style="color: #5E5E5E;">&amp;</span> <span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">&lt;</span><span class="fl" style="color: #AD0000;">40</span>,<span class="op" style="color: #5E5E5E;">]</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">pred6</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">~</span><span class="va" style="color: #111111;">age</span>, </span>
<span>                    data <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">[</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">&gt;=</span><span class="fl" style="color: #AD0000;">40</span>,<span class="op" style="color: #5E5E5E;">]</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">tri.age.plot</span> <span class="op" style="color: #5E5E5E;">+</span> </span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op" style="color: #5E5E5E;">(</span>data<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">[</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">&lt;</span><span class="fl" style="color: #AD0000;">5</span>,<span class="op" style="color: #5E5E5E;">]</span>, </span>
<span>            <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>y <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">pred1</span>, x<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">)</span>, size <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">1</span>, col<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"blue"</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op" style="color: #5E5E5E;">(</span>data<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">[</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">age</span> <span class="op" style="color: #5E5E5E;">&gt;=</span><span class="fl" style="color: #AD0000;">5</span> <span class="op" style="color: #5E5E5E;">&amp;</span> <span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">&lt;</span><span class="fl" style="color: #AD0000;">10</span>,<span class="op" style="color: #5E5E5E;">]</span>, </span>
<span>            <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>y <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">pred2</span>, x<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">)</span>, size <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">1</span>, col<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"blue"</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op" style="color: #5E5E5E;">(</span>data<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">[</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">&gt;=</span><span class="fl" style="color: #AD0000;">10</span> <span class="op" style="color: #5E5E5E;">&amp;</span> <span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">&lt;</span><span class="fl" style="color: #AD0000;">20</span>,<span class="op" style="color: #5E5E5E;">]</span>, </span>
<span>            <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>y <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">pred3</span>, x<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">)</span>, size <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">1</span>, col<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"blue"</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op" style="color: #5E5E5E;">(</span>data<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">[</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">&gt;=</span><span class="fl" style="color: #AD0000;">20</span> <span class="op" style="color: #5E5E5E;">&amp;</span> <span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">&lt;</span><span class="fl" style="color: #AD0000;">30</span>,<span class="op" style="color: #5E5E5E;">]</span>, </span>
<span>            <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>y <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">pred4</span>, x<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">)</span>, size <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">1</span>, col<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"blue"</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op" style="color: #5E5E5E;">(</span>data<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">[</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">&gt;=</span><span class="fl" style="color: #AD0000;">30</span> <span class="op" style="color: #5E5E5E;">&amp;</span> <span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">&lt;</span><span class="fl" style="color: #AD0000;">40</span>,<span class="op" style="color: #5E5E5E;">]</span>, </span>
<span>            <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>y <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">pred5</span>, x<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">)</span>, size <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">1</span>, col<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"blue"</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op" style="color: #5E5E5E;">(</span>data<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">[</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">&gt;=</span><span class="fl" style="color: #AD0000;">40</span>,<span class="op" style="color: #5E5E5E;">]</span>, </span>
<span>            <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>y <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">pred6</span>, x<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">)</span>, size <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">1</span>, col<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"blue"</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<p><img src="https://mcdr65.github.io/myblog/posts/fromLMtoSplines/index_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="continuous-piecewise-linear-regression" class="level3"><h3 class="anchored" data-anchor-id="continuous-piecewise-linear-regression">Continuous piecewise linear regression</h3>
<p>We want a continuous function. Let us define a <em>truncated power basis function</em> (here of degree=1) per knot <img src="https://latex.codecogs.com/png.latex?%5Cxi">,</p>
<p><img src="https://latex.codecogs.com/png.latex?h(x,%20%5Cxi)=(x-%5Cxi)%5E1_%7B+%7D=%0A%5Cbegin%7Bcases%7D%0A%20%20x-%5Cxi,%20%5Ctext%7B%5C,if%5C,%7D%20x%3E%5Cxi%5C%5C%0A%20%200,%20%5Ctext%7B%5C,else%7D.%0A%5Cend%7Bcases%7D%0A"></p>
<p>The continuous piecewise regression equation is</p>
<p><img src="https://latex.codecogs.com/png.latex?Y_i=%5Cbeta_0+%5Cbeta_1x_i+%5Cbeta_2%20h(x_i,5)+%5Ccdots+%5Cbeta_6%20h(x_i,40)%20+%20%5Cepsilon_i"></p>
<p>This can be done -by hand- or with B-splines <code><a href="https://rdrr.io/r/splines/bs.html">splines::bs()</a></code></p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb16" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">pred7</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">~</span> <span class="va" style="color: #111111;">age</span> <span class="op" style="color: #5E5E5E;">+</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">-</span><span class="fl" style="color: #AD0000;">5</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">*</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">&gt;=</span><span class="fl" style="color: #AD0000;">5</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>                                   <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">-</span><span class="fl" style="color: #AD0000;">10</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">*</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">age</span> <span class="op" style="color: #5E5E5E;">&gt;=</span> <span class="fl" style="color: #AD0000;">10</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>                                   <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">-</span><span class="fl" style="color: #AD0000;">20</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">*</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">age</span> <span class="op" style="color: #5E5E5E;">&gt;=</span> <span class="fl" style="color: #AD0000;">20</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>                                   <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">-</span><span class="fl" style="color: #AD0000;">30</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">*</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">age</span> <span class="op" style="color: #5E5E5E;">&gt;=</span> <span class="fl" style="color: #AD0000;">30</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>                                  <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">-</span><span class="fl" style="color: #AD0000;">40</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">*</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">age</span> <span class="op" style="color: #5E5E5E;">&gt;=</span> <span class="fl" style="color: #AD0000;">40</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>                    data <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">splines</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">pred.lm.bs</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">triceps</span> <span class="op" style="color: #5E5E5E;">~</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/splines/bs.html">bs</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">age</span>, knots <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">5</span>,<span class="fl" style="color: #AD0000;">10</span>,<span class="fl" style="color: #AD0000;">20</span>,<span class="fl" style="color: #AD0000;">30</span>,<span class="fl" style="color: #AD0000;">40</span><span class="op" style="color: #5E5E5E;">)</span>,degree<span class="op" style="color: #5E5E5E;">=</span><span class="fl" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">)</span>, data<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">tri.age.plot</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op" style="color: #5E5E5E;">(</span>data<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">triceps</span>, </span>
<span>            <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>y <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">pred.lm.bs</span>, x<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">)</span>, size <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">1</span>, col<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"blue"</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op" style="color: #5E5E5E;">(</span>data<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">triceps</span>, </span>
<span>            <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>y <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">pred7</span><span class="op" style="color: #5E5E5E;">+</span><span class="fl" style="color: #AD0000;">.2</span>, x<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">)</span>, size <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">1</span>, col<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"red"</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<p><img src="https://mcdr65.github.io/myblog/posts/fromLMtoSplines/index_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<!-- ## Piecewise quadratic polynomial -->
</section></section><section id="splines" class="level2"><h2 class="anchored" data-anchor-id="splines">Splines</h2>
<section id="quadratic-spline" class="level3"><h3 class="anchored" data-anchor-id="quadratic-spline">Quadratic spline</h3>
<p>With</p>
<p><img src="https://latex.codecogs.com/png.latex?h(x,%20%5Cxi)=(x-%5Cxi)_%7B+%7D%5E2=%0A%5Cbegin%7Bcases%7D%0A%20%20(x-%5Cxi)%5E2,%20%5Ctext%7B%5C,if%5C,%7D%20x%3E%5Cxi%5C%5C%0A%20%200,%20%5Ctext%7B%5C,else%7D,%0A%5Cend%7Bcases%7D%0A"></p>
<p>we have as regression equation <img src="https://latex.codecogs.com/png.latex?Y_i=%5Cbeta_0+%5Cbeta_1x_i+%5Cbeta_2x_i%5E2+%5Cbeta_3%20h(x_i,5)+%5Ccdots+%5Cbeta_7%20h(x_i,40)%20+%20%5Cepsilon_i"></p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb17" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">pred.quadsmooth</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">~</span> <span class="va" style="color: #111111;">age</span> <span class="op" style="color: #5E5E5E;">+</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">^</span><span class="fl" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span> </span>
<span>                    <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">-</span><span class="fl" style="color: #AD0000;">5</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">^</span><span class="fl" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">*</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">&gt;=</span><span class="fl" style="color: #AD0000;">5</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>                    <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">-</span><span class="fl" style="color: #AD0000;">10</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">^</span><span class="fl" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">*</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">&gt;=</span><span class="fl" style="color: #AD0000;">10</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>                    <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">-</span><span class="fl" style="color: #AD0000;">20</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">^</span><span class="fl" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">*</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">&gt;=</span><span class="fl" style="color: #AD0000;">20</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>                    <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">-</span><span class="fl" style="color: #AD0000;">30</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">^</span><span class="fl" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">*</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">&gt;=</span><span class="fl" style="color: #AD0000;">30</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>                    <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">-</span><span class="fl" style="color: #AD0000;">40</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">^</span><span class="fl" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">*</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">&gt;=</span><span class="fl" style="color: #AD0000;">40</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span>,</span>
<span>                    data <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">pred.quadsmooth2</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">triceps</span> <span class="op" style="color: #5E5E5E;">~</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/splines/bs.html">bs</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">age</span>, knots <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">5</span>,<span class="fl" style="color: #AD0000;">10</span>,<span class="fl" style="color: #AD0000;">20</span>,<span class="fl" style="color: #AD0000;">30</span>,<span class="fl" style="color: #AD0000;">40</span><span class="op" style="color: #5E5E5E;">)</span>,degree<span class="op" style="color: #5E5E5E;">=</span><span class="fl" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">)</span>, data<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span>                        </span>
<span><span class="va" style="color: #111111;">tri.age.plot</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op" style="color: #5E5E5E;">(</span>data<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">triceps</span>, </span>
<span>            <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>y <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">pred.quadsmooth</span>, x<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">)</span>, size <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">1</span>, col<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"blue"</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">+</span></span>
<span>  <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op" style="color: #5E5E5E;">(</span>data<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">triceps</span>, </span>
<span>            <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>y <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">pred.quadsmooth2</span><span class="op" style="color: #5E5E5E;">+</span><span class="fl" style="color: #AD0000;">.2</span>, x<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">age</span><span class="op" style="color: #5E5E5E;">)</span>, size <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">1</span>, col<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"red"</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<p><img src="https://mcdr65.github.io/myblog/posts/fromLMtoSplines/index_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="cubic-spline" class="level3"><h3 class="anchored" data-anchor-id="cubic-spline">Cubic Spline</h3>
<p>Most often, cubic splines are used. Adding the following truncated power basis function per knot,</p>
<p><img src="https://latex.codecogs.com/png.latex?h(x,%20%5Cxi)=(x-%5Cxi)_%7B+%7D%5E3=%0A%5Cbegin%7Bcases%7D%0A%20%20(x-%5Cxi)%5E3,%20%5Ctext%7B%5C,if%5C,%7D%20x%3E%5Cxi%5C%5C%0A%20%200,%20%5Ctext%7B%5C,else%7D,%0A%5Cend%7Bcases%7D%0A"></p>
<p>to the model for a cubic polynomial will lead to a discontinuity in <em>only the third derivative</em> at <img src="https://latex.codecogs.com/png.latex?%5Cxi">; the function will remain continuous, with <em>continuous first and second derivatives, at each of the knots</em>:</p>
<p><img src="https://latex.codecogs.com/png.latex?Y_i=%5Cbeta_0+%5Cbeta_1x_i+%5Cbeta_2x_i%5E2+%5Cbeta_3x_i%5E3+%5Cbeta_4h(x_i,5)+%5Ccdots+%5Cbeta_8h(x_i,40)%20+%20%5Cepsilon_i"></p>
<p>One can show that a cubic spline has <img src="https://latex.codecogs.com/png.latex?K+4"> parameters.</p>
</section><section id="natural-spline" class="level3"><h3 class="anchored" data-anchor-id="natural-spline">Natural Spline</h3>
<p>Natural splines have an additional restriction that the fitted curve <em>linear at the extremes</em>, <code><a href="https://rdrr.io/r/splines/ns.html">splines::ns()</a></code></p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb18" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">cub.splines.bs</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">triceps</span> <span class="op" style="color: #5E5E5E;">~</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/splines/bs.html">bs</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">age</span>, knots <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">5</span>,<span class="fl" style="color: #AD0000;">10</span>,<span class="fl" style="color: #AD0000;">20</span>,<span class="fl" style="color: #AD0000;">30</span>,<span class="fl" style="color: #AD0000;">40</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span>, data<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">cub.splines.ns</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">triceps</span> <span class="op" style="color: #5E5E5E;">~</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/splines/ns.html">ns</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">age</span>, knots <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">5</span>,<span class="fl" style="color: #AD0000;">10</span>,<span class="fl" style="color: #AD0000;">20</span>,<span class="fl" style="color: #AD0000;">30</span>,<span class="fl" style="color: #AD0000;">40</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span>, data<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details>
</div>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb19" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">tri.age.plot</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">triceps</span>, <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op" style="color: #5E5E5E;">(</span>x<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">age</span>, y<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>                 <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op" style="color: #5E5E5E;">(</span>alpha<span class="op" style="color: #5E5E5E;">=</span><span class="fl" style="color: #AD0000;">0.55</span>, color<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"black"</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span> </span>
<span>                 <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="op" style="color: #5E5E5E;">)</span> </span>
<span><span class="va" style="color: #111111;">tri.age.plot</span> <span class="op" style="color: #5E5E5E;">+</span></span>
<span>    <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">stat_smooth</a></span><span class="op" style="color: #5E5E5E;">(</span>method <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"lm"</span>, </span>
<span>               formula <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">y</span><span class="op" style="color: #5E5E5E;">~</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/splines/bs.html">bs</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">x</span>,knots <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">5</span>,<span class="fl" style="color: #AD0000;">10</span>,<span class="fl" style="color: #AD0000;">20</span>,<span class="fl" style="color: #AD0000;">30</span>,<span class="fl" style="color: #AD0000;">40</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span>, </span>
<span>               lty <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">1</span>, col <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"green"</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">+</span> </span>
<span>    <span class="fu" style="color: #4758AB;"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html">stat_smooth</a></span><span class="op" style="color: #5E5E5E;">(</span>method <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"lm"</span>, </span>
<span>               formula <span class="op" style="color: #5E5E5E;">=</span> <span class="va" style="color: #111111;">y</span><span class="op" style="color: #5E5E5E;">~</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/splines/ns.html">ns</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">x</span>,knots <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">5</span>,<span class="fl" style="color: #AD0000;">10</span>,<span class="fl" style="color: #AD0000;">20</span>,<span class="fl" style="color: #AD0000;">30</span>,<span class="fl" style="color: #AD0000;">40</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span>, </span>
<span>               lty <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">1</span>, col <span class="op" style="color: #5E5E5E;">=</span> <span class="st" style="color: #20794D;">"red"</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p></p><figcaption class="figure-caption">polynomial cubic splines (green), natural cubic splines (red)</figcaption><p></p>
<p><img src="https://mcdr65.github.io/myblog/posts/fromLMtoSplines/index_files/figure-html/ns-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="smoothing-splines" class="level2"><h2 class="anchored" data-anchor-id="smoothing-splines">Smoothing splines</h2>
<p>Avoids the knot selection problem completely by using a maximal set of knots. The complexity of the fit is controlled by regularization. Problem: among all functions <img src="https://latex.codecogs.com/png.latex?f(x)"> with two continuous derivatives, find one that minimizes the penalized residual sum of squares</p>
<p><span id="eq-RSS"><img src="https://latex.codecogs.com/png.latex?%0A%20%20RSS(f,%5Clambda)=%5Csum_%7Bi=1%7D%5EN(y_i-f(x_i))%5E2+%5Clambda%5Bf''(t)%5D%5E2dt%0A%5Ctag%7B1%7D"></span></p>
<p>where <img src="https://latex.codecogs.com/png.latex?%5Clambda"> is a fixed smoothing parameter. The first term measures closeness to the data, while the second term penalizes curvature in the function, and <img src="https://latex.codecogs.com/png.latex?%5Clambda"> establishes a tradeoff between the two. Special cases: <img src="https://latex.codecogs.com/png.latex?%5Clambda=0"> (no constraint on <img src="https://latex.codecogs.com/png.latex?f">) and <img src="https://latex.codecogs.com/png.latex?%5Clambda=%5Cinfty"> (<img src="https://latex.codecogs.com/png.latex?f"> has to be linear).</p>
<p>The function <img src="https://latex.codecogs.com/png.latex?f(x)"> that minimizes (Equation&nbsp;1) can be shown to have some special properties: it is a piecewise cubic polynomial with knots at the unique values of <img src="https://latex.codecogs.com/png.latex?x_1,%5Cdots,x_n"> and continuous first and second derivatives at each knot. Furthermore, it is linear in the region outside of the extreme knots. In other words, the function <img src="https://latex.codecogs.com/png.latex?f(x)"> that minimizes (Equation&nbsp;1) is a natural cubic spline with knots at <img src="https://latex.codecogs.com/png.latex?x_1,%5Cdots,x_n"> ! However, it is not the same natural cubic spline that one would get if one applied the basis function approach described above – rather, it is a shrunken version of such a natural cubic spline, where the value of the tuning parameter <img src="https://latex.codecogs.com/png.latex?%5Clambda"> in (Equation&nbsp;1) controls the level of shrinkage.</p>
<p>Smoothing splines are implemented in <code><a href="https://rdrr.io/r/stats/smooth.spline.html">smooth.spline()</a></code>.</p>
<section id="lambda-determined-with-cross-validation" class="level3"><h3 class="anchored" data-anchor-id="lambda-determined-with-cross-validation">
<img src="https://latex.codecogs.com/png.latex?%5Clambda"> determined with cross-validation</h3>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb20" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">sspline</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/smooth.spline.html">smooth.spline</a></span><span class="op" style="color: #5E5E5E;">(</span>x<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">age</span>, y<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">triceps</span>, cv<span class="op" style="color: #5E5E5E;">=</span><span class="cn" style="color: #8f5902;">TRUE</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Warning in smooth.spline(x = triceps$age, y = triceps$triceps, cv = TRUE): cross-validation with non-unique 'x' values
seems doubtful</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb22" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">age</span>, <span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">sspline</span>, lwd<span class="op" style="color: #5E5E5E;">=</span><span class="fl" style="color: #AD0000;">3</span>,col<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"red"</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<p><img src="https://mcdr65.github.io/myblog/posts/fromLMtoSplines/index_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="the-extremes-no-smooth-and-max-smooth" class="level3"><h3 class="anchored" data-anchor-id="the-extremes-no-smooth-and-max-smooth">The extremes: no smooth and max smooth</h3>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb23" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">ssplineNosmooth</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/smooth.spline.html">smooth.spline</a></span><span class="op" style="color: #5E5E5E;">(</span>x<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">age</span>, y<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">triceps</span>, lambda<span class="op" style="color: #5E5E5E;">=</span><span class="fl" style="color: #AD0000;">0</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">ssplineMaxsmooth</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/smooth.spline.html">smooth.spline</a></span><span class="op" style="color: #5E5E5E;">(</span>x<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">age</span>, y<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">triceps</span>, lambda<span class="op" style="color: #5E5E5E;">=</span><span class="fl" style="color: #AD0000;">100</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">age</span>, <span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">$</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">ssplineNosmooth</span>, lwd<span class="op" style="color: #5E5E5E;">=</span><span class="fl" style="color: #AD0000;">2</span>,col<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"red"</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">ssplineMaxsmooth</span>, lwd<span class="op" style="color: #5E5E5E;">=</span><span class="fl" style="color: #AD0000;">2</span>,col<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"blue"</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<p><img src="https://mcdr65.github.io/myblog/posts/fromLMtoSplines/index_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">

</div>
</section></section><section id="generalized-additive-model" class="level2"><h2 class="anchored" data-anchor-id="generalized-additive-model">Generalized additive model</h2>
<p>Using <code><a href="https://rdrr.io/pkg/mgcv/man/gam.html">mgcv::gam()</a></code></p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb24" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw" style="color: #003B4F;"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">mgcv</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output cell-output-stderr">
<pre><code>Loading required package: nlme</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>This is mgcv 1.8-35. For overview type 'help("mgcv-package")'.</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb27" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">gamtri</span><span class="op" style="color: #5E5E5E;">&lt;-</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/mgcv/man/gam.html">gam</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">~</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/pkg/mgcv/man/s.html">s</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">age</span>,bs<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"cr"</span><span class="op" style="color: #5E5E5E;">)</span>,data<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">triceps</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">gamtri</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>
Family: gaussian 
Link function: identity 

Formula:
triceps ~ s(age, bs = "cr")

Parametric coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)   9.7024     0.1255   77.29   &lt;2e-16

Approximate significance of smooth terms:
         edf Ref.df    F p-value
s(age) 6.706  7.539 85.6  &lt;2e-16

R-sq.(adj) =  0.419   Deviance explained = 42.3%
GCV =  14.18  Scale est. = 14.057    n = 892</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb29" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">gamtri</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<p><img src="https://mcdr65.github.io/myblog/posts/fromLMtoSplines/index_files/figure-html/GAM-1.png" class="img-fluid" width="672"></p>
</div>
</div>


</section> ]]></description>
  <category>code</category>
  <category>analysis</category>
  <guid>https://mcdr65.github.io/myblog/posts/fromLMtoSplines/index.html</guid>
  <pubDate>Wed, 05 Oct 2022 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Exponential Growth</title>
  <dc:creator>André Meichtry</dc:creator>
  <link>https://mcdr65.github.io/myblog/posts/exponentialGrowth/index.html</link>
  <description><![CDATA[ <p><em>The greatest shortcoming of the human race is the inability to understand the exponential function. (Al Bartlett)</em></p>
<section id="problem" class="level1"><h1>Problem</h1>
<p>Sie sitzen zuoberst in einem Fussball-Stadion; es hat Platz für <img src="https://latex.codecogs.com/png.latex?6%5Ctimes%2010%5E%7B13%7D"> Wassertropfen. Es beginnt mit einem Tropfen, der in der ersten Minute ins Stadion tröpfelt. Jede Minute <em>verdoppelt</em> sich die Anzahl Tropfen. Lange passiert nichts Besonderes. Sie sehen die Gefahr nicht kommen. Von der <em>Hälfte</em> bis <em>ganz</em> oben geht es plötzlich sehr schnell. Es würde auch nicht viel bringen, wenn das Stadion noch viel grösser wäre; wir haben <strong>exponentielles Wachstum</strong>.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">max</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fl" style="color: #AD0000;">3e06</span><span class="op" style="color: #5E5E5E;">*</span><span class="fl" style="color: #AD0000;">20e06</span> <span class="co" style="color: #5E5E5E;">##Volumen Allianz-Arena</span></span>
<span><span class="va" style="color: #111111;">halb</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="va" style="color: #111111;">max</span><span class="op" style="color: #5E5E5E;">/</span><span class="fl" style="color: #AD0000;">2</span></span>
<span><span class="va" style="color: #111111;">max2</span><span class="op" style="color: #5E5E5E;">&lt;-</span><span class="va" style="color: #111111;">max</span><span class="op" style="color: #5E5E5E;">*</span><span class="fl" style="color: #AD0000;">2</span></span>
<span><span class="va" style="color: #111111;">tmax</span><span class="op" style="color: #5E5E5E;">&lt;-</span><span class="fl" style="color: #AD0000;">50</span></span>
<span><span class="va" style="color: #111111;">t</span><span class="op" style="color: #5E5E5E;">&lt;-</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">0</span>,<span class="va" style="color: #111111;">tmax</span>,by<span class="op" style="color: #5E5E5E;">=</span><span class="fl" style="color: #AD0000;">0.1</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">expwachs</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="kw" style="color: #003B4F;">function</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">t</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;">{</span><span class="va" style="color: #111111;">y</span><span class="op" style="color: #5E5E5E;">&lt;-</span><span class="fl" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">*</span><span class="fl" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">^</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">t</span><span class="op" style="color: #5E5E5E;">/</span><span class="fl" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">}</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">t</span>,<span class="fu" style="color: #4758AB;">expwachs</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">t</span><span class="op" style="color: #5E5E5E;">)</span>,type<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"l"</span>,ylim<span class="op" style="color: #5E5E5E;">=</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">0</span>,<span class="va" style="color: #111111;">max2</span><span class="op" style="color: #5E5E5E;">)</span>,main<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">""</span>,ylab<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"Volumen [Wassertropfen]"</span>, xlab<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"Minuten"</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op" style="color: #5E5E5E;">(</span>side <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">1</span>, at <span class="op" style="color: #5E5E5E;">=</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">0</span>,<span class="va" style="color: #111111;">tmax</span>,by<span class="op" style="color: #5E5E5E;">=</span><span class="fl" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op" style="color: #5E5E5E;">(</span>h<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">max</span>,lty<span class="op" style="color: #5E5E5E;">=</span><span class="fl" style="color: #AD0000;">2</span>,col<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"red"</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op" style="color: #5E5E5E;">(</span>v<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">t</span><span class="op" style="color: #5E5E5E;">[</span><span class="fl" style="color: #AD0000;">458</span><span class="op" style="color: #5E5E5E;">]</span>,lty<span class="op" style="color: #5E5E5E;">=</span><span class="fl" style="color: #AD0000;">2</span>,col<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"red"</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op" style="color: #5E5E5E;">(</span>h<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">halb</span>,lty<span class="op" style="color: #5E5E5E;">=</span><span class="fl" style="color: #AD0000;">2</span>,col<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"blue"</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op" style="color: #5E5E5E;">(</span>v<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">t</span><span class="op" style="color: #5E5E5E;">[</span><span class="fl" style="color: #AD0000;">448</span><span class="op" style="color: #5E5E5E;">]</span>,lty<span class="op" style="color: #5E5E5E;">=</span><span class="fl" style="color: #AD0000;">2</span>,col<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"blue"</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p></p><figcaption class="figure-caption">Exponentielles Wachstum</figcaption><p></p>
<p><img src="https://mcdr65.github.io/myblog/posts/exponentialGrowth/index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="exponentialfunktion" class="level1"><h1>Exponentialfunktion</h1>
<p><strong>Jede Exponentialfunktion <img src="https://latex.codecogs.com/png.latex?a%5Ex"> mit <img src="https://latex.codecogs.com/png.latex?a%3E1"> wächst ab einem gewissen <img src="https://latex.codecogs.com/png.latex?x"> schneller als jede lineare Funktion <img src="https://latex.codecogs.com/png.latex?a+bx"></strong>.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb2" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">10</span><span class="op" style="color: #5E5E5E;">*</span><span class="va" style="color: #111111;">x</span>,from<span class="op" style="color: #5E5E5E;">=</span><span class="fl" style="color: #AD0000;">0</span>,to<span class="op" style="color: #5E5E5E;">=</span><span class="fl" style="color: #AD0000;">60</span>,ylab<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"y"</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">20</span><span class="op" style="color: #5E5E5E;">*</span><span class="va" style="color: #111111;">x</span>,add<span class="op" style="color: #5E5E5E;">=</span><span class="cn" style="color: #8f5902;">TRUE</span>,lty<span class="op" style="color: #5E5E5E;">=</span><span class="fl" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">^</span><span class="va" style="color: #111111;">x</span>,add<span class="op" style="color: #5E5E5E;">=</span><span class="cn" style="color: #8f5902;">TRUE</span>,lty<span class="op" style="color: #5E5E5E;">=</span><span class="fl" style="color: #AD0000;">3</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/graphics/curve.html">curve</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">1.2</span><span class="op" style="color: #5E5E5E;">^</span><span class="va" style="color: #111111;">x</span>,add<span class="op" style="color: #5E5E5E;">=</span><span class="cn" style="color: #8f5902;">TRUE</span>,lty<span class="op" style="color: #5E5E5E;">=</span><span class="fl" style="color: #AD0000;">4</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p></p><figcaption class="figure-caption">Exponentialfunktion und lineare Funktion</figcaption><p></p>
<p><img src="https://mcdr65.github.io/myblog/posts/exponentialGrowth/index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="exponentielles-wachstum" class="level1"><h1>Exponentielles Wachstum</h1>
<p><strong>Exponential growth</strong> is defined by</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Cboxed%7Bx(t)=x_0e%5E%7Bkt%7D=x_0e%5E%7Bt/%5Ctau%7D=x_02%5E%7Bt/T%7D%7D,"></p>
<p>with <img src="https://latex.codecogs.com/png.latex?t">: time, <img src="https://latex.codecogs.com/png.latex?%5Ctau">: <img src="https://latex.codecogs.com/png.latex?e">-folding time, <img src="https://latex.codecogs.com/png.latex?T">: doubling time, <img src="https://latex.codecogs.com/png.latex?k">: growth constant. <sup>1</sup></p>
<ul>
<li><p>Bei Verdoppelung alle 2 Tage: <img src="https://latex.codecogs.com/png.latex?2%5E%7Bt/2%7D=(2%5E%7B1/2%7D)%5Et=1.41%5Et"></p></li>
<li><p>Bei Verdoppelung alle 3 Tage: <img src="https://latex.codecogs.com/png.latex?2%5E%7Bt/3%7D=(2%5E%7B1/3%7D)%5Et=1.26%5Et"></p></li>
<li><p>Bei Verdoppelung alle 7 Tage: <img src="https://latex.codecogs.com/png.latex?2%5E%7Bt/7%7D=(2%5E%7B1/7%7D)%5Et=1.1%5Et"></p></li>
<li><p>Bei Verdoppelung alle 10 Tage: <img src="https://latex.codecogs.com/png.latex?2%5E%7Bt/10%7D=(2%5E%7B1/10%7D)%5Et=1.07%5Et"></p></li>
</ul>
<!-- # Daten Covid-19 --><!-- <https://github.com/openZH/covid_19> --><!-- ```{r echo=FALSE} --><!-- data<-read.csv("https://raw.githubusercontent.com/openZH/covid_19/master/COVID19_Fallzahlen_CH_total.csv") --><!-- str(data) --><!-- names(data)[3]<-"Kanton" --><!-- data<-data[,-11] --><!-- sKcases<-split(data$ncumul_conf,data$Kanton) --><!-- sKfatal<-split(data$ncumul_deceased,data$Kanton) --><!-- sKhosp<-split(data$ncumul_hosp,data$Kanton) --><!-- sKICU<-split(data$ncumul_ICU,data$Kanton) --><!-- sKvent<-split(data$ncumul_vent,data$Kanton) --><!-- ``` --><!-- ## Reported cases --><!-- ```{r} --><!-- CasesKanton<-sapply(sKcases,function(x){x[max(which(!is.na(x)))]}) --><!-- CasesKanton --><!-- sum(CasesKanton) --><!-- ``` --><!-- ## Deceased --><!-- ```{r} --><!-- FatKanton<-sapply(sKfatal,function(x){x[max(which(!is.na(x)))]}) --><!-- FatKanton --><!-- sum(FatKanton,na.rm=TRUE) --><!-- ``` --></section><section id="covid-19" class="level1"><h1>Covid-19</h1>
<section id="inzidenz-und-kumulierte-inzidenz" class="level2"><h2 class="anchored" data-anchor-id="inzidenz-und-kumulierte-inzidenz">Inzidenz und kumulierte Inzidenz</h2>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb3" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">data</span><span class="op" style="color: #5E5E5E;">&lt;-</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="st" style="color: #20794D;">"https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_global.csv"</span>,check.names<span class="op" style="color: #5E5E5E;">=</span><span class="cn" style="color: #8f5902;">FALSE</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">sw</span><span class="op" style="color: #5E5E5E;">&lt;-</span><span class="va" style="color: #111111;">data</span><span class="op" style="color: #5E5E5E;">[</span><span class="va" style="color: #111111;">data</span><span class="op" style="color: #5E5E5E;">$</span><span class="st" style="color: #20794D;">"Country/Region"</span><span class="op" style="color: #5E5E5E;">==</span><span class="st" style="color: #20794D;">"Switzerland"</span>,<span class="op" style="color: #5E5E5E;">-</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">1</span>,<span class="fl" style="color: #AD0000;">2</span>,<span class="fl" style="color: #AD0000;">3</span>,<span class="fl" style="color: #AD0000;">4</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">]</span></span>
<span><span class="va" style="color: #111111;">cases</span><span class="op" style="color: #5E5E5E;">&lt;-</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">sw</span><span class="op" style="color: #5E5E5E;">[</span><span class="op" style="color: #5E5E5E;">-</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">:</span><span class="fl" style="color: #AD0000;">42</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">]</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">incid</span><span class="op" style="color: #5E5E5E;">&lt;-</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">cases</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">t</span><span class="op" style="color: #5E5E5E;">&lt;-</span><span class="fl" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">:</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">incid</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">ma</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="kw" style="color: #003B4F;">function</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">x</span>, <span class="va" style="color: #111111;">n</span> <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">7</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">{</span><span class="fu" style="color: #4758AB;">stats</span><span class="fu" style="color: #4758AB;">::</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">x</span>, <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">1</span> <span class="op" style="color: #5E5E5E;">/</span> <span class="va" style="color: #111111;">n</span>, <span class="va" style="color: #111111;">n</span><span class="op" style="color: #5E5E5E;">)</span>, sides <span class="op" style="color: #5E5E5E;">=</span> <span class="fl" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">}</span>  <span class="co" style="color: #5E5E5E;">##moving average over 7 days</span></span>
<span><span class="va" style="color: #111111;">incidAv</span><span class="op" style="color: #5E5E5E;">&lt;-</span><span class="fu" style="color: #4758AB;">ma</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">incid</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">t</span>,<span class="va" style="color: #111111;">incid</span>,type<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"l"</span>,col<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"blue"</span>,lty<span class="op" style="color: #5E5E5E;">=</span><span class="fl" style="color: #AD0000;">2</span>,xlab<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"Tage"</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">t</span>,<span class="va" style="color: #111111;">incidAv</span>,col<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"red"</span>,lwd<span class="op" style="color: #5E5E5E;">=</span><span class="fl" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p></p><figcaption class="figure-caption">Inzidenz</figcaption><p></p>
<p><img src="https://mcdr65.github.io/myblog/posts/exponentialGrowth/index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb4" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">:</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">cases</span><span class="op" style="color: #5E5E5E;">)</span>,<span class="va" style="color: #111111;">cases</span>,type<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"l"</span>,col<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"blue"</span>,lwd<span class="op" style="color: #5E5E5E;">=</span><span class="fl" style="color: #AD0000;">2</span>,xlab<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"Tage"</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p></p><figcaption class="figure-caption">kumulierte Indzidenz</figcaption><p></p>
<p><img src="https://mcdr65.github.io/myblog/posts/exponentialGrowth/index_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb5" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">:</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">cases</span><span class="op" style="color: #5E5E5E;">)</span>,<span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">cases</span><span class="op" style="color: #5E5E5E;">)</span>,type<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"l"</span>,col<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"blue"</span>,lwd<span class="op" style="color: #5E5E5E;">=</span><span class="fl" style="color: #AD0000;">2</span>,xlab<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"Tage"</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p></p><figcaption class="figure-caption">log kumulierte Indzidenz</figcaption><p></p>
<p><img src="https://mcdr65.github.io/myblog/posts/exponentialGrowth/index_files/figure-html/unnamed-chunk-6-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="erste-welle-covid-19" class="level2"><h2 class="anchored" data-anchor-id="erste-welle-covid-19">Erste Welle Covid-19</h2>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb6" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">swisspop</span><span class="op" style="color: #5E5E5E;">&lt;-</span><span class="fl" style="color: #AD0000;">8e6</span></span>
<span><span class="va" style="color: #111111;">time</span><span class="op" style="color: #5E5E5E;">&lt;-</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">1</span>,<span class="fl" style="color: #AD0000;">60</span>,by<span class="op" style="color: #5E5E5E;">=</span><span class="fl" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">tag</span><span class="op" style="color: #5E5E5E;">&lt;-</span><span class="fl" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">:</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">cases</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">T1</span><span class="op" style="color: #5E5E5E;">&lt;-</span><span class="fl" style="color: #AD0000;">1</span></span>
<span><span class="va" style="color: #111111;">T2</span><span class="op" style="color: #5E5E5E;">&lt;-</span><span class="fl" style="color: #AD0000;">2</span></span>
<span><span class="va" style="color: #111111;">T3</span><span class="op" style="color: #5E5E5E;">&lt;-</span><span class="fl" style="color: #AD0000;">3</span></span>
<span><span class="va" style="color: #111111;">T7</span><span class="op" style="color: #5E5E5E;">&lt;-</span><span class="fl" style="color: #AD0000;">7</span></span>
<span><span class="va" style="color: #111111;">x0</span><span class="op" style="color: #5E5E5E;">&lt;-</span><span class="fl" style="color: #AD0000;">100</span></span>
<span><span class="va" style="color: #111111;">Y1</span><span class="op" style="color: #5E5E5E;">&lt;-</span><span class="va" style="color: #111111;">x0</span><span class="op" style="color: #5E5E5E;">*</span><span class="fl" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">^</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">time</span><span class="op" style="color: #5E5E5E;">/</span><span class="va" style="color: #111111;">T1</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">Y2</span><span class="op" style="color: #5E5E5E;">&lt;-</span><span class="va" style="color: #111111;">x0</span><span class="op" style="color: #5E5E5E;">*</span><span class="fl" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">^</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">time</span><span class="op" style="color: #5E5E5E;">/</span><span class="va" style="color: #111111;">T2</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">Y3</span><span class="op" style="color: #5E5E5E;">&lt;-</span><span class="va" style="color: #111111;">x0</span><span class="op" style="color: #5E5E5E;">*</span><span class="fl" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">^</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">time</span><span class="op" style="color: #5E5E5E;">/</span><span class="va" style="color: #111111;">T3</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">Y7</span><span class="op" style="color: #5E5E5E;">&lt;-</span><span class="va" style="color: #111111;">x0</span><span class="op" style="color: #5E5E5E;">*</span><span class="fl" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">^</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">time</span><span class="op" style="color: #5E5E5E;">/</span><span class="va" style="color: #111111;">T7</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">time</span><span class="op" style="color: #5E5E5E;">&lt;-</span><span class="va" style="color: #111111;">time</span><span class="op" style="color: #5E5E5E;">+</span><span class="fl" style="color: #AD0000;">1</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">time</span>,<span class="va" style="color: #111111;">Y1</span>,type<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"l"</span>,ylab<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"cases"</span>,ylim<span class="op" style="color: #5E5E5E;">=</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">100</span>,<span class="fl" style="color: #AD0000;">10000</span><span class="op" style="color: #5E5E5E;">)</span>,xlab<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"days"</span>,las<span class="op" style="color: #5E5E5E;">=</span><span class="fl" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">time</span>,<span class="va" style="color: #111111;">Y3</span>,col<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"red"</span>,lty<span class="op" style="color: #5E5E5E;">=</span><span class="fl" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">time</span>,<span class="va" style="color: #111111;">Y2</span>,lty<span class="op" style="color: #5E5E5E;">=</span><span class="fl" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">time</span>,<span class="va" style="color: #111111;">Y7</span>,lty<span class="op" style="color: #5E5E5E;">=</span><span class="fl" style="color: #AD0000;">3</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op" style="color: #5E5E5E;">(</span>h<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">swisspop</span>,lty<span class="op" style="color: #5E5E5E;">=</span><span class="fl" style="color: #AD0000;">5</span>,col<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"red"</span><span class="op" style="color: #5E5E5E;">)</span> </span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">tag</span>,<span class="va" style="color: #111111;">cases</span>,type<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"l"</span>,col<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"red"</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p></p><figcaption class="figure-caption">Inzidenz</figcaption><p></p>
<p><img src="https://mcdr65.github.io/myblog/posts/exponentialGrowth/index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb7" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">time</span>,<span class="va" style="color: #111111;">Y1</span>,log<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"y"</span>,type<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"l"</span>,ylab<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"cases"</span>,xlab<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"days"</span>,axes<span class="op" style="color: #5E5E5E;">=</span><span class="cn" style="color: #8f5902;">FALSE</span>,ylim<span class="op" style="color: #5E5E5E;">=</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">100</span>,<span class="fl" style="color: #AD0000;">40000</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">at.y</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/outer.html">outer</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">:</span><span class="fl" style="color: #AD0000;">9</span>, <span class="fl" style="color: #AD0000;">10</span><span class="op" style="color: #5E5E5E;">^</span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">:</span><span class="fl" style="color: #AD0000;">9</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">lab.y</span> <span class="op" style="color: #5E5E5E;">&lt;-</span> <span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/Log.html">log10</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">at.y</span><span class="op" style="color: #5E5E5E;">)</span> <span class="op" style="color: #5E5E5E;"><a href="https://rdrr.io/r/base/Arithmetic.html">%%</a></span> <span class="fl" style="color: #AD0000;">1</span> <span class="op" style="color: #5E5E5E;">==</span> <span class="fl" style="color: #AD0000;">0</span>, <span class="va" style="color: #111111;">at.y</span>, <span class="cn" style="color: #8f5902;">NA</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">2</span>, at<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">at.y</span>, labels<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">lab.y</span>, las<span class="op" style="color: #5E5E5E;">=</span><span class="fl" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/graphics/axis.html">axis</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">1</span>,<span class="va" style="color: #111111;">time</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">time</span>,<span class="va" style="color: #111111;">Y2</span>,lty<span class="op" style="color: #5E5E5E;">=</span><span class="fl" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">time</span>,<span class="va" style="color: #111111;">Y7</span>,lty<span class="op" style="color: #5E5E5E;">=</span><span class="fl" style="color: #AD0000;">3</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">time</span>,<span class="va" style="color: #111111;">Y3</span>,col<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"red"</span>,lty<span class="op" style="color: #5E5E5E;">=</span><span class="fl" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op" style="color: #5E5E5E;">(</span>h<span class="op" style="color: #5E5E5E;">=</span><span class="va" style="color: #111111;">swisspop</span>,col<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"red"</span>,lty<span class="op" style="color: #5E5E5E;">=</span><span class="fl" style="color: #AD0000;">3</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">tag</span>,<span class="va" style="color: #111111;">cases</span>,type<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"l"</span>,col<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"red"</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p></p><figcaption class="figure-caption">log Inzidenz</figcaption><p></p>
<p><img src="https://mcdr65.github.io/myblog/posts/exponentialGrowth/index_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>Erste Welle. Example of doubling times: 1 day (solid), 2 days (dashed), 3 days (red), seven days (dotted), with reported cases Covid19 in Switzerland. Horizontal line: swiss population. On a logarithmic scale, a straight line indicates exponential growth. <a href="https://www.arcgis.com/apps/opsdashboard/index.html#/bda7594740fd40299423467b48e9ecf6">Quelle</a></strong>.</p>
</section><section id="auswirkung-vorfaktor" class="level2"><h2 class="anchored" data-anchor-id="auswirkung-vorfaktor">Auswirkung Vorfaktor</h2>
<p>Annahme: Verdoppelung alle drei Tage, 10 Prozent der Infizierten müssen ins Spital. Die Anzahl Cases von heute sind die Anzahl Spitalpatienten in 9 Tagen, <strong>wenn mann nichts macht</strong>.</p>
<p><img src="https://latex.codecogs.com/png.latex?0.1%5Ctimes%202%5E%7B0.33t%7D=0.1%5Ctimes%20(2%5E%7B0.33%7D)%5Et=0.1%5Ctimes%201.3%5Et=1.3%5E%7B%5Clog_%7B1.3%7D0.1%7D1.3%5Et=1.3%5E%7Bt+%5Clog_%7B1.3%7D0.1%7D=1.3%5E%7Bt-8.776%7D"></p>
<p>Analog kann man zeigen: Wenn die Mortalitätsrate bei einem Prozent der bestätigten Fälle liegt, dann ist die Anzahl der bestätigten Fälle die zu erwartende Anzahl der Todesfälle ca. 18 Tage später, <strong>wenn man nichts macht</strong>.</p>
<p><img src="https://latex.codecogs.com/png.latex?0.01%5Ctimes%202%5E%7B0.33t%7D=0.01%5Ctimes%20(2%5E%7B0.33%7D)%5Et=0.01%5Ctimes%201.3%5Et=1.3%5E%7B%5Clog_%7B1.3%7D0.01%7D1.3%5Et=1.3%5E%7Bt+%5Clog_%7B1.3%7D0.01%7D=1.3%5E%7Bt-17.553%7D"></p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb8" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">delay</span><span class="op" style="color: #5E5E5E;">&lt;-</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">0.1</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">/</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">1.3</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">delay</span></span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] -8.776291</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb10" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va" style="color: #111111;">delay2</span><span class="op" style="color: #5E5E5E;">&lt;-</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">0.01</span><span class="op" style="color: #5E5E5E;">)</span><span class="op" style="color: #5E5E5E;">/</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">1.3</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="va" style="color: #111111;">delay2</span></span></code></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] -17.55258</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb12" style="background: #f1f3f5;"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">time</span>,<span class="fl" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">^</span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">0.33</span><span class="op" style="color: #5E5E5E;">*</span><span class="va" style="color: #111111;">time</span><span class="op" style="color: #5E5E5E;">)</span>,ylab<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"cases"</span>,xlab<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"days"</span>,type<span class="op" style="color: #5E5E5E;">=</span><span class="st" style="color: #20794D;">"l"</span>,ylim<span class="op" style="color: #5E5E5E;">=</span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="fl" style="color: #AD0000;">0</span>,<span class="fl" style="color: #AD0000;">10000</span><span class="op" style="color: #5E5E5E;">)</span>,col<span class="op" style="color: #5E5E5E;">=</span><span class="fl" style="color: #AD0000;">3</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">time</span>,<span class="fl" style="color: #AD0000;">0.1</span><span class="op" style="color: #5E5E5E;">*</span><span class="fl" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">^</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">time</span><span class="op" style="color: #5E5E5E;">/</span><span class="fl" style="color: #AD0000;">3</span><span class="op" style="color: #5E5E5E;">)</span>,lty<span class="op" style="color: #5E5E5E;">=</span><span class="fl" style="color: #AD0000;">1</span>,col<span class="op" style="color: #5E5E5E;">=</span><span class="fl" style="color: #AD0000;">1</span><span class="op" style="color: #5E5E5E;">)</span></span>
<span><span class="fu" style="color: #4758AB;"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">time</span>,<span class="fl" style="color: #AD0000;">0.01</span><span class="op" style="color: #5E5E5E;">*</span><span class="fl" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">^</span><span class="op" style="color: #5E5E5E;">(</span><span class="va" style="color: #111111;">time</span><span class="op" style="color: #5E5E5E;">/</span><span class="fl" style="color: #AD0000;">3</span><span class="op" style="color: #5E5E5E;">)</span>,lty<span class="op" style="color: #5E5E5E;">=</span><span class="fl" style="color: #AD0000;">1</span>,col<span class="op" style="color: #5E5E5E;">=</span><span class="fl" style="color: #AD0000;">2</span>,lwd<span class="op" style="color: #5E5E5E;">=</span><span class="fl" style="color: #AD0000;">2</span><span class="op" style="color: #5E5E5E;">)</span></span></code></pre></div>
</details><div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p></p><figcaption class="figure-caption">Auswirkung Vorfaktor</figcaption><p></p>
<p><img src="https://mcdr65.github.io/myblog/posts/exponentialGrowth/index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section></section><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>
<ol>
<li id="fn1"><p>Proof: <img src="https://latex.codecogs.com/png.latex?x(t)=x_0e%5E%7Bkt%7D=x_0e%5E%7Bt/%5Ctau%7D=x_0%202%5E%7B%5Cfrac%7Bt%7D%7B%5Ctau%7D%5Clog_2e%7D=x_02%5E%7B%5Cfrac%7Bt%7D%7B%5Ctau%7D%20%5Cfrac%7B1%7D%7B%5Clog%202%20%7D%7D=x_02%5E%7Bt/T%7D">↩︎</p></li>
</ol></section></div> ]]></description>
  <category>news</category>
  <category>code</category>
  <category>analysis</category>
  <guid>https://mcdr65.github.io/myblog/posts/exponentialGrowth/index.html</guid>
  <pubDate>Wed, 28 Sep 2022 22:00:00 GMT</pubDate>
</item>
<item>
  <title>Welcome To My Blog</title>
  <dc:creator>André Meichtry</dc:creator>
  <link>https://mcdr65.github.io/myblog/posts/welcome/index.html</link>
  <description><![CDATA[ 



<p>Welcome!</p>



 ]]></description>
  <category>news</category>
  <guid>https://mcdr65.github.io/myblog/posts/welcome/index.html</guid>
  <pubDate>Sun, 25 Sep 2022 22:00:00 GMT</pubDate>
</item>
</channel>
</rss>
